@model IEnumerable<Authentication.Models.Brochure>
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2>List of brochures</h2>
<div id="example">
    <table id="grid">
        <colgroup>
            <col />
            <col />
            <col style="width:110px" />
            <col style="width:100px" />
        </colgroup>
        <thead id="table_head">
            <tr>
                <th data-field="Name">Name</th>
                <th>CRUD</th>

            </tr>
        </thead>
        <tbody id="table_data">
            @foreach (var c in ViewBag.DataTable)
            {
                <tr>
                    <td>
                        <p>@c.Name</p>
                    </td>
                    <td>
                        <p>
                            <a class="btn" href="/Brochures/Details/@c.Id">Смотреть</a>

                            @if (User.IsInRole("admin") || User.IsInRole("user"))
                            {
                                <a class="btn" href="/Brochures/Edit/@c.Id">Редактировать </a>
                            }

                            @if (User.IsInRole("admin"))
                            {
                                <a class="btn" onclick="ConfirmDelete(@c.Id)">Удалить </a>
                            }
                            <a class="btn" href="/Brochures/Save/@c.Id">Save</a>

                        </p>
                    </td>
                </tr>
            }
        </tbody>
    </table>

    <form class="form-inline" method="post" action="/brochures/Create">
        <div class="form-group">
            <label>Name:</label>
            <input id="Name" name="Name" type="text" class="form-control">
        </div>
        <div class="form-group">
            <label>Author:</label>
            <input id="Color" name="Color" type="text" class="form-control">
        </div>
        <div class="form-group">
            <label>Theme:</label>
            <input id="Theme" name="Theme" type="text" class="form-control">
        </div>
        <div class="form-group">
            <label>Price:</label>
            <input id="Price" name="Price" type="text" class="form-control">
        </div>

        <button type="submit" class="btn btn-default">Добавить</button>
    </form>

    <script>
    function ConfirmDelete(id) {
        var ok = confirm('Вы уверены, что хотите удалить?')
        if (ok)
            location = "/Brochures/Delete/" + id;
        else
            location = "/Brochures/Index/"
    }

    function Table() {
        var target_head = $("#table_head");
        target_head.empty();
        target_head.append("<tr>< th data- field='Name'>Name</th><th>CRUD</th></tr >");
        var target_data = $("#table_data");
        target_data.empty();


    }

    $(document).ready(function () {
        $("#grid").kendoGrid({
            height: 500,
            sortable: true,

        });
    });
    </script>
</div>


<script>
    $(document).ready(function () {
 
        $.ajaxSetup({ cache: false });
 
        $(".viewDialog").on("click", function (e) {
            e.preventDefault();
 
            $("<div></div>")
                .addClass("dialog")
                .appendTo("body")
                .dialog({
                    title: $(this).attr("data-dialog-title"),
                     close: function () { $(this).remove() },
                    modal: true
                })
                .load(this.href);
        });
    });
</script>
